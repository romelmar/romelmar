{
    "sourceFile": "resources/views/scripts/route_crud.blade.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1654132523745,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1654132523745,
            "name": "Commit-0",
            "content": "<script type=\"text/javascript\">\r\n    $.ajaxSetup({\r\n        headers: {\r\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n        }\r\n    });\r\n\r\n    $(\"#addRoute\").click(function(e) {\r\n\r\n        e.preventDefault();\r\n        $(this).text('Updating...');\r\n        URL = $(\"#add_route_form\").attr('action');\r\n\r\n        var date_received = $(\"input[name=date_received]\").val();\r\n        var doc_id = $(\"input[name=doc_id]\").val();\r\n        var employee_id = $(\"input[name=employee_id]\").val();\r\n        var division_id = $(\"input[name=division_id]\").val();\r\n        var action = $(\"textarea[name=action]\").val();\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: \"{{ route('docroutes.create') }}\",\r\n            data: {\r\n                date_received: date_received,\r\n                doc_id: doc_id,\r\n                action: action,\r\n                employee_id: employee_id,\r\n                division_id: division_id,\r\n            },\r\n            success: function(response) {\r\n                if (response.status == \"success\") {\r\n                    Swal.fire(\r\n                        'Updated!',\r\n                        'Document Route Updated Successfully!',\r\n                        'success'\r\n                    )\r\n                    fetchAllRoutes();\r\n                }\r\n                $(\"#addRouteModal\").modal('hide');\r\n                $(\"button#addRoute\").text('Update Document');\r\n                $(\"#add_route_form\")[0].reset();\r\n            },\r\n            error: function(error) {\r\n                console.log(error)\r\n            }\r\n        });\r\n    });\r\n\r\n    // ----------------------- edit Route -------------------------------------------\r\n    $(document).on('click', '.editIcon', function(e) {\r\n        e.preventDefault();\r\n\r\n        let id = $(this).attr('id');\r\n        $.ajax({\r\n            url: \"{{ route('edit.doc_route') }}\",\r\n            method: 'get',\r\n            data: {\r\n                id: id,\r\n                _token: '{{ csrf_token() }}'\r\n            },\r\n            success: function(response) {\r\n\r\n                dr = response[0].date_received;\r\n                $(\"#editRouteModal textarea[name='action'\").val(response.action);\r\n\r\n                for (let x in response[0]) {\r\n\r\n                    var el = document.querySelector('#editRoute');\r\n                    el.setAttribute('data-id', id);\r\n\r\n                    if (x.search(\"_id\") < 0) $(\"#editRouteModal #\" + x).val(response[0][x]);\r\n                    else {\r\n                        name = x.replace('_id', '');\r\n\r\n                        $(\"#editRouteModal input[name='\" + x + \"'\").val(response[0][x]);\r\n                        $(\"#editRouteModal #\" + x).val(response[name]);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    $(\"button#editRoute\").click(function(e) {\r\n        e.preventDefault();\r\n\r\n        var date_received = $(\"#editRouteModal input[name=date_received]\").val();\r\n        var action = $(\"#editRouteModal textarea[name=action]\").val();\r\n        var division_id = $(\"#editRouteModal input[name=division_id]\").val();\r\n        var employee_id = $(\"#editRouteModal input[name=employee_id]\").val();\r\n\r\n        var el = document.querySelector(\"button#editRoute\");\r\n        var id = el.getAttribute('data-id');\r\n\r\n        $(this).text('Updating...');\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '{{ route('update.doc_route') }}',\r\n            data: {\r\n\r\n                date_received: date_received,\r\n                action: action,\r\n                division_id: division_id,\r\n                employee_id: employee_id,\r\n                id: id\r\n\r\n            },\r\n            method: 'put',\r\n            success: function(data) {\r\n                // console.log(data.success);\r\n                if (data.status == 200) {\r\n                    Swal.fire(\r\n                        'Updated!',\r\n                        'Document Route Updated Successfully! ',\r\n                        'success'\r\n                    )\r\n                    fetchAllRoutes();\r\n                }\r\n                $(\"#editRouteModal\").modal('hide');\r\n                $(\"button#editRoute\").text('Update Document');\r\n                $(\"#add_route_form\")[0].reset();\r\n\r\n            }\r\n        });\r\n    });\r\n\r\n    // ----------------------------------------------------------------\r\n    fetchAllRoutes();\r\n\r\n    function fetchAllRoutes() {\r\n        $.ajax({\r\n            url: '{{ route('fetchAllRoute', $document->id) }}',\r\n            method: 'get',\r\n            success: function(response) {\r\n                $(\"#show_all_documents\").html(response);\r\n                var table = $('#myTable').DataTable({\r\n                    \"order\": [\r\n                        [1, \"desc\"]\r\n                    ],\r\n                    columnDefs: [{\r\n                        orderable: false,\r\n                        targets: [2]\r\n                    }]\r\n                });\r\n\r\n                table.columns().iterator('column', function(ctx, idx) {\r\n                    $(table.column(idx).header()).prepend('<span class=\"sort-icon\"/>');\r\n                });\r\n            }\r\n        });\r\n    }\r\n</script>"
        }
    ]
}