{
    "sourceFile": "resources/views/scripts/document_add.blade.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1653960954006,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1653965292732,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,3 +1,217 @@\n-<script>\r\n-    alert(\"hey\");\r\n-</script>\n\\ No newline at end of file\n+$.ajaxSetup({\r\n+    headers: {\r\n+        'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n+    }\r\n+\r\n+});\r\n+\r\n+$(\"button#addDocument\").click(function(e) {\r\n+    e.preventDefault();\r\n+\r\n+    var date_received = $(\"input[name=date_received]\").val();\r\n+    var deadline = $(\"input[name=deadline]\").val();\r\n+    var subject = $(\"input[name=subject]\").val();\r\n+    var origin_id = $(\"input[name=origin_id]\").val();\r\n+    var employee_id = $(\"input[name=employee_id]\").val();\r\n+    var doctype_id = $(\"input[name=doctype_id]\").val();\r\n+    var mor_id = $(\"input[name=mor_id]\").val();\r\n+    var control_number = $(\"input[name=control_number]\").val();\r\n+\r\n+    $(this).text('Adding...');\r\n+\r\n+    $.ajax({\r\n+        type: 'POST',\r\n+        url: \"{{ route('storeAjax') }}\",\r\n+        data: {\r\n+\r\n+            date_received: date_received,\r\n+            deadline: deadline,\r\n+            subject: subject,\r\n+            origin_id: origin_id,\r\n+            employee_id: employee_id,\r\n+            doctype_id: doctype_id,\r\n+            mor_id: mor_id,\r\n+            control_number: control_number\r\n+\r\n+        },\r\n+        success: function(data) {\r\n+            // console.log(data.success);\r\n+            if (data.status == 200) {\r\n+                Swal.fire(\r\n+                    'Added!',\r\n+                    'Document Added Successfully!',\r\n+                    'success'\r\n+                )\r\n+                fetchAllDocuments();\r\n+            }\r\n+            $(\"button#addDocument\").text('Add Document');\r\n+            $(\"#addDocumentForm\")[0].reset();\r\n+            $(\"#addDocumentModal\").modal('hide');\r\n+        }\r\n+    });\r\n+});\r\n+\r\n+// edit employee ajax request\r\n+$(document).on('click', '.editIcon', function(e) {\r\n+    e.preventDefault();\r\n+\r\n+    let id = $(this).attr('id');\r\n+    $.ajax({\r\n+        url: \"{{ route('edit.doc') }}\",\r\n+        method: 'get',\r\n+        data: {\r\n+            id: id,\r\n+            _token: '{{ csrf_token() }}'\r\n+        },\r\n+        success: function(response) {\r\n+\r\n+            dr = response[0].date_received;\r\n+            for (let x in response[0]) {\r\n+\r\n+                var el = document.querySelector('#updateDocument');\r\n+                el.setAttribute('data-id', id);\r\n+\r\n+                if (x.search(\"_id\") < 0) $(\"#editDocumentModal #\" + x).val(response[0][x]);\r\n+                else {\r\n+                    name = x.replace('_id', '');\r\n+\r\n+                    $(\"#editDocumentModal input[name='\" + x + \"'\").val(response[0][x]);\r\n+                    $(\"#editDocumentModal #\" + x).val(response[name]);\r\n+                }\r\n+            }\r\n+        }\r\n+    });\r\n+});\r\n+\r\n+// update employee ajax request\r\n+\r\n+$(\"button#updateDocument\").click(function(e) {\r\n+    e.preventDefault();\r\n+\r\n+    var date_received = $(\"#editDocumentModal input[name=date_received]\").val();\r\n+    var deadline = $(\"#editDocumentModal input[name=deadline]\").val();\r\n+    var subject = $(\"#editDocumentModal input[name=subject]\").val();\r\n+    var origin_id = $(\"#editDocumentModal input[name=origin_id]\").val();\r\n+    var employee_id = $(\"#editDocumentModal input[name=employee_id]\").val();\r\n+    var doctype_id = $(\"#editDocumentModal input[name=doctype_id]\").val();\r\n+    var mor_id = $(\"#editDocumentModal input[name=mor_id]\").val();\r\n+    var control_number = $(\"#editDocumentModal input[name=control_number]\").val();\r\n+    var el = document.querySelector(\"button#updateDocument\");\r\n+    var id = el.getAttribute('data-id');\r\n+    // var id = 38;\r\n+\r\n+    $(this).text('Updating...');\r\n+\r\n+    $.ajax({\r\n+        type: 'POST',\r\n+        url: \"{{ route('update.doc') }}\",\r\n+        data: {\r\n+\r\n+            date_received: date_received,\r\n+            deadline: deadline,\r\n+            subject: subject,\r\n+            origin_id: origin_id,\r\n+            employee_id: employee_id,\r\n+            doctype_id: doctype_id,\r\n+            mor_id: mor_id,\r\n+            control_number: control_number,\r\n+            id: id\r\n+\r\n+        },\r\n+        method: 'put',\r\n+        success: function(data) {\r\n+            // console.log(data.success);\r\n+            if (data.status == 200) {\r\n+                Swal.fire(\r\n+                    'Updated!',\r\n+                    'Document Updated Successfully!',\r\n+                    'success'\r\n+                )\r\n+                fetchAllDocuments();\r\n+            }\r\n+            $(\"#editDocumentModal\").modal('hide');\r\n+            $(\"button#updateDocument\").text('Update Document');\r\n+\r\n+        }\r\n+    });\r\n+});\r\n+\r\n+// delete employee ajax request\r\n+$(document).on('click', '.deleteIcon', function(e) {\r\n+    e.preventDefault();\r\n+    let id = $(this).attr('id');\r\n+    let csrf = '{{ csrf_token() }}';\r\n+    Swal.fire({\r\n+        title: 'Are you sure?',\r\n+        text: \"You won't be able to revert this!\",\r\n+        icon: 'warning',\r\n+        showCancelButton: true,\r\n+        confirmButtonColor: '#3085d6',\r\n+        cancelButtonColor: '#d33',\r\n+        confirmButtonText: 'Yes, delete it!'\r\n+    }).then((result) => {\r\n+        if (result.isConfirmed) {\r\n+            $.ajax({\r\n+                url: \"{{ route('delete') }}\",\r\n+                method: 'delete',\r\n+                data: {\r\n+                    id: id,\r\n+                    _token: csrf\r\n+                },\r\n+                success: function(response) {\r\n+                    // console.log(response);\r\n+                    Swal.fire(\r\n+                        'Deleted!',\r\n+                        'Your file has been deleted.',\r\n+                        'success'\r\n+                    )\r\n+                    fetchAllDocuments();\r\n+                }\r\n+            });\r\n+        }\r\n+    })\r\n+});\r\n+\r\n+// fetch all employees ajax request\r\n+fetchAllDocuments();\r\n+\r\n+function fetchAllDocuments() {\r\n+    $.ajax({\r\n+        url: \"{{ route('fetchAll.doc') }}\",\r\n+        method: 'get',\r\n+        success: function(response) {\r\n+            $(\"#show_all_documents\").html(response);\r\n+            var table = $('#myTable').DataTable({\r\n+                \"order\": [\r\n+                    [5, \"desc\"]\r\n+                ],\r\n+                columnDefs: [\r\n+                    {\r\n+                        \"targets\": [0],\r\n+                        \"visible\": false,\r\n+                        \"searchable\": false\r\n+                    },\r\n+\r\n+                    {\r\n+                        \"targets\": [3],\r\n+                        \"visible\": false,\r\n+                    },\r\n+\r\n+                    {\r\n+                        \"targets\": [6],\r\n+                        \"visible\": false,\r\n+                        \"searchable\": false\r\n+                    },\r\n+                    {\r\n+                        orderable: false,\r\n+                        targets: [5, 6]\r\n+                    }\r\n+                ]\r\n+            });\r\n+\r\n+            table.columns().iterator('column', function(ctx, idx) {\r\n+                $(table.column(idx).header()).prepend('<span class=\"sort-icon\"/>');\r\n+            });\r\n+        }\r\n+    });\r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1653965299012,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,5 @@\n+<script>\r\n $.ajaxSetup({\r\n     headers: {\r\n         'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n     }\r\n@@ -213,5 +214,6 @@\n                 $(table.column(idx).header()).prepend('<span class=\"sort-icon\"/>');\r\n             });\r\n         }\r\n     });\r\n-}\n\\ No newline at end of file\n+}\r\n+</script>\n\\ No newline at end of file\n"
                }
            ],
            "date": 1653960954006,
            "name": "Commit-0",
            "content": "<script>\r\n    alert(\"hey\");\r\n</script>"
        }
    ]
}